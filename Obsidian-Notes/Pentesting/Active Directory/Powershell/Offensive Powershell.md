# Offensive Powershell
---
# Navigation
- **[[#Reconnaissance]]**
	- [[#PortScanning Host discovery]]
	- [[#Directory bruteforce]]
	- [[#Shodan]]
	- [[#Automating Nmap]]
	- [[#Brute-Force]]
	- 

> **Note:**
>  To list the modules and parameters for a specific function in a module -> [[Powershell Basics#List module commands]]
---
# Reconnaissance
## PortScanning & Host discovery
```Powershell
#Powersploit module
Invoke-PortScan <Args> | Select-Object -ExpandProperty openports
#Posh-SecMod module
portscan <Args>
Invoke-ARPScan <Args>
Invoke-EnumSRVRecords <Args>
```
## Directory discovery
```powershell
#PowerSploit module
Get-HttpStatus <Args> | Where-Object {$_.Status -match "ok"}
```
## Shodan
```powershell
#Posh-Shodan module
Get-Command -module Posh-shodan
```
## Automating Nmap
```powershell
#Scandiff script
./scandiff.ps1 -frequency daily -basename nmap-output -targets 192.168.1.10-25,scanme.nmap.org
```
> **Scandiff**: https://github.com/hardwaterhacker/scandiff
## Brute-Force
**Nishang module:**
-  **Services:** FTP , Active Directory, MSSQL, Sharepoint.
```powershell
cat <PassFile> | Invoke-BruteForce -IP <IP> -UserName <Username>  -service ActiveDirectory
cat C:\test\servers.txt | Invoke-BruteForce -UserList C:\test\users.txt -PasswordList C:\test\wordlist.txt -Service SQL -Verbose
```
- **Services:** WinRM & Wmi
```powershell
Get-WinRMPassword -UserName Administrator -ComputerName victimserver -WordList c:\mywordlist.txt
```
>**Sources:**
> Script -> [WinRMPassword](https://poshsecurity.com/blog/2014/3/20/powershell-winrm-get-winrmpassword.html)
> 
