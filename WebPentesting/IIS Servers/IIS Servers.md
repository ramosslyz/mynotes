# Pentesting IIS Servers.
## Naviagation
- **[Shortname Scanner](#Shortname%20Scanner)**
- **[Finding API Documentation](#Finding%20API%20Documentation)**
- **[Vhost hopping](#Vhost%20hopping)**
- **[Local File Disclosure](#Local%20File%20Disclosure)**
- **[DnSpy to reverse dll's](#DnSpy%20to%20reverse%20dll's)**
- **[XXE Vectors](#XXE%20Vectors)**
---
## Microsoft ASP.NET Fingerprinting
**Cookies:**
- ASP.NET_SessionId
- ASPSESSION

**Headers Regex:**
- X-AspNet-Version: (.+)\\\\;Version:\\\1,
- X-Powered-By: \^ASP\\\.NET

**HTML Regex:**
- <input[\^>]+name=\\"_VIEWSTATE

**URL Regex:**
- \\\.aspx?(?:$|\\\\?)

## Shortname Scanner
![IIS1](IIS1.png)
![IIS2](IIS2.png)
![IIS3](IIS3.png)]
![IIS4](IIS4.png)
![IIS5](IIS5.png)
![IIS6](IIS6.png)
> Research link: http://soroush.secproject.com/downloadable/microsoft_iis_tilde_character_vulnerability_feature.pdf

> Tool link: https://github.com/irsdl/IIS-ShortName-Scanner

## Finding API Documentation
![IIS7](IIS7.png)
![IIS8](IIS8.png)
![IIS9](IIS9.png)
>  Blog post on using BigQuery to find the rest of the shortname: [https://bit.ly/35P5maY](https://www.youtube.com/redirect?event=video_description&redir_token=QUFFLUhqbkctSXVPWFZ4NFpJUzFEeXB1YWZyMW56X0o4Z3xBQ3Jtc0tsak9ULUFQY25UWDB2cnZvbmh1Q3l5alVIWm5NY3hsMWN2LVA3WUJUVVVaV1BFTkp4allPLVREQk92dHdEOWxiU0RiSkVuRTdQQlNqa2JLWkpETkRkSE1DRkxDSG1TYXRoVVc1a0xkWVZLUFUtTVltYw&q=https%3A%2F%2Fbit.ly%2F35P5maY)



## Vhost hopping
**Can get you access to internal panels**
![vhost1](vhost1.png)

## Local File Disclosure
![lfd](lfd.png)

### RCE via File Disclosure
![lfd to rce](lfd%20to%20rce.png)

## DnSpy to reverse dll's
![dnspy](dnspy.png)

## XXE Vectors
![xxe](xxe.png)