# Navigation
- [**CloudWatch-Mertics**](#CloudWatch-Mertics)
	- [CloudWatch-Custom-Metrics](#CloudWatch-Custom-Metrics)
	- [CloudWatch-Dashboards](#CloudWatch-Dashboards)
	- [CloudWatch-Logs](#CloudWatch-Logs)
	- [CloudWatch-Logs-Metric-Filter](#CloudWatch-Logs-Metric-Filter)
	- [CloudWatch-Logs–S3Export](#CloudWatch-Logs–S3Export)
	- [CloudWatch-Logs-Agent-and-Unified-Agent](#CloudWatch-Logs-Agent-and-Unified-Agent)
- [**EC2-Detailed-monitoring**](#EC2-Detailed-monitoring)
	- [CloudWatch-Logs-EC2](#CloudWatch-Logs-EC2)
- [**CloudWatch-Alarm-Targets**](#CloudWatch-Alarm-Targets)
- [**Amazon-EventBridge**](#Amazon-EventBridge)
	- [Schema-Registry](#Schema-Registry)
	- [Resource-based-Policy](#Resource-based-Policy)
	- [EventBridge-vs-CloudWatch-Events](#EventBridge-vs-CloudWatch-Events)
- [AWS-CloudTrail](#AWS-CloudTrail)
# CloudWatch-Mertics
- CloudWatch provides metrics for every services in AWS
- Up to 10 dimensions per metric  
- Metrics have timestamps  
- Can create CloudWatch dashboards of metrics
## CloudWatch-Custom-Metrics
- Possibility to define and send your own custom metrics to CloudWatch  
	- Example: memory (RAM) usage, disk space, number of logged in users ...  
- Use API call **PutMetricData**  
- Ability to use dimensions (attributes) to segment metrics  
	- Instance.id  
	- Environment.name  
- Metric resolution (StorageResolution API parameter – two possible value):  
	- Standard: 1 minute (60 seconds)  
	- High Resolution: 1/5/10/30 second(s) – Higher cost  
- **Note**: Accepts metric data points two weeks in the past and two hours in the future (make sure to configure your EC2 instance time correctly)
# CloudWatch-Dashboards
- Great way to setup custom dashboards for quick access to key metrics and alarms  
- **Dashboards are global**  
- **Dashboards can include graphs from different AWS accounts and regions**  
- You can change the time zone & time range of the dashboards  
- You can setup automatic refresh (10s, 1m, 2m, 5m, 15m)  
- **Dashboards can be shared with people who don’t have an AWS account** (public, email address, 3 rd party SSO provider through Amazon Cognito)
## CloudWatch-Logs
- **Log groups**: arbitrary name, usually representing an application  
- **Log stream**: instances within application / log files / containers  
- Can define log expiration policies (never expire, 30 days, etc..)  
- **CloudWatch Logs can send logs to**:  
	- Amazon S3 (exports)  
	- Kinesis Data Streams  
	- Kinesis Data Firehose  
	- AWS Lambda  
	- ElasticSearch
## CloudWatch-Logs-Metric-Filter
- CloudWatch Logs can use filter expressions  
	- For example, find a specific IP inside of a log  
	- Or count occurrences of “ERROR” in your logs  
- Metric filters can be used to trigger CloudWatch alarms  
- CloudWatch Logs Insights can be used to query logs and add queries to CloudWatch Dashboards
## CloudWatch-Logs–S3Export
- Log data can take **up to 12 hours** to become available for export  
- The API call is **CreateExportTask**  
> **Note**: Not near-real time or real-time... use Logs Subscriptions instead
## CloudWatch-Logs-Agent-and-Unified-Agent
- For virtual servers (EC2 instances, on-premises servers...)  
- **CloudWatch Logs Agent**  
	- Old version of the agent  
	- Can only send to CloudWatch Logs  
- **CloudWatch Unified Agent**  
	- Collect additional system-level metrics such as RAM, processes, etc...  
	- Collect logs to send to CloudWatch Logs  
	- Centralized configuration using SSM Parameter Store
	- - Collected directly on your Linux server / EC2 instance  
	- CPU (active, guest, idle, system, user, steal)  
	- Disk metrics (free, used, total), Disk IO (writes, reads, bytes, iops)  
	- RAM (free, inactive, used, total, cached)  
	- Netstat (number of TCP and UDP connections, net packets, bytes)  
	- Processes (total, dead, bloqued, idle, running, sleep)  
	- Swap Space (free, used, used %)  
	- **Reminder**: out-of-the box metrics for EC2 – disk, CPU, network (high level)
# EC2-Detailed-monitoring
- EC2 instance metrics have metrics “every 5 minutes”  
- With detailed monitoring (for a cost), you get data “every 1 minute”  
- Use detailed monitoring if you want to scale faster for your ASG!  
- The AWS Free Tier allows us to have 10 detailed monitoring metrics  
> **Note**: EC2 Memory usage is by default not pushed (must be pushed  from inside the instance as a custom metric)
## CloudWatch-Logs-EC2
- By default, no logs from your EC2 machine will go to CloudWatch  
- You need to run a CloudWatch agent on EC2 to push the log filesyou want  
- Make sure IAM permissions are correct  
- The CloudWatch log agent can be setup on-premises too
# CloudWatch-Alarm-Targets
- Stop,Terminate,Reboot or Recover an EC2 instance
- Trigger Auto Scaling group
- Send Notification from SNS
# Amazon-EventBridge
- EventBridge is the next evolution of CloudWatch Events  
- **Default Event Bus** – generated by AWS services (CloudWatch Events)  
- **Partner Event Bus** – receive events from SaaS service or applications (Zendesk, DataDog, Segment, Auth0...)  
- **Custom Event Buses** – for your own applications  
- Event buses can be accessed by other AWS accounts  
- You can archive events (all/filter) sent to an event bus (indefinitely or set period)  
- Ability to replay archived events
## Schema-Registry
- EventBridge can analyze the events in your bus and infer the schema  
- The **Schema Registry** allows you to generate code for your application, that will know in advance how data is structured in the event bus  
- Schema can be versioned
## Resource-based-Policy
- Manage permissions for a specific Event Bus
- **Example**: Allow/deny events from another AWS account or AWS region
- **Use case**:
	- Aggregate all events from your AWS Organization in a single AWS account or AWS region.
## EventBridge-vs-CloudWatch-Events
- Amazon EventBridge *builds upon and extends CloudWatch Events*.  
- It uses the same service API and endpoint, and the same underlying service infrastructure.  
- EventBridge allows extension to add event buses for your custom applications and your third-party SaaS apps.  
- Event Bridge has the Schema Registry capability  
- EventBridge has a different name to mark the new capabilities  
- Over time, the CloudWatch Events name will be replaced with EventBridge
# AWS-CloudTrail