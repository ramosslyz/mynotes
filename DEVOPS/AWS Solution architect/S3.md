# Amazon S3 Overview - Buckets  
- Amazon S3 allows people to store objects (files) in “buckets” (directories)  
- Buckets must have a globally unique name  
- Buckets are defined at the region level  
- Naming convention  
- No uppercase  
- No underscore  
- 3-63 characters long  
- Not an IP  
- Must start with lowercase letter or number
- Object values are the content of the body:  
- **Max Object Size is 5TB (5000GB)**  
- If uploading more than 5GB, must use "multi-part upload"


## S3 Encryption for Objects  
- **There are 4 methods of encrypting objects in S3**  
	- **SSE-S3**: encrypts S3 objects using keys handled & managed by AWS  
		- Object is encrypted server side  
		- AES-256 encryption type  
		- Must set header: “x-amz-server-side-encryption": "AES256
	- **SSE-KMS**: leverage AWS Key Management Service to manage encryption keys  
		- KMS Advantages: user control + audit trail  
		- Object is encrypted server side  
		-  Must set header: “x-amz-server-side-encryption": ”aws:kms"
	- **SSE-C**: when you want to manage your own encryption keys
		- Amazon S3 does not store the encryption key you provide  
		- HTTPS must be used  
		- Encryption key must provided in HTTP headers, for every HTTP request made  
	- **Client Side Encryption**
		- Client library such as the Amazon S3 Encryption Client  
	- Clients must encrypt data themselves before sending to S3  
	- Clients must decrypt data themselves when retrieving from S3  
	- Customer fully manages the keys and encryption cycle
# Advanced Amazon S3

## S3 MFA-Delete
- You will need MFA to
	- Permanently delete an object version
	- Suspend versioning on the bucket
- You won’t need MFA for:
	- Enabling versioning
	- Listing deleted versions
- **Only the bucket owner (root account) can enable/disable MFA-Delete**
- MFA-Delete currently can only be enabled using the CLI
## S3 Access log :Warning
- Don't set your logging bucket to be the monitored bucket as it will create a logging loopback, and the bucket will grow exponentially.
## S3 Replication (CRR & SRR)
- Must enable versioning in source and destination  
- Cross Region Replication (**CRR**)  
- Same Region Replication (**SRR**)  
- Buckets can be in different accounts  
- Copying is asynchronous  
- Must give proper IAM permissions to S3  
- **CRR - Use cases**: compliance, lower latency access, replication across accounts  
- **SRR – Use cases**: log aggregation, live replication between production and test accounts
  
## S3 Replication – Notes  
- After activating, only new objects are replicated  
- Optionally, you can replicate existing objects using **S3 Batch Replication**  
	- Replicates existing objects and objects that failed replication  
- **For DELETE operations**:  
	- Can replicate delete markers from source to target (optional setting)  
	- Deletions with a version ID are not replicated (to avoid malicious deletes)  
- **There is no "chaining" of replication**  
	- If bucket 1 has replication into bucket 2, which has replication into bucket 3  
	- Then objects created in bucket 1 are not replicated to bucket 3
## S3 Pre-Signed URLs  
- Can generate pre-signed URLs using SDK or CLI  
- For downloads (easy, **can use the CLI**)  
- For uploads (harder, **must use the SDK**)  
- Valid for a default of **3600** seconds, can change timeout with --expires-in [TIME_BY_SECONDS] argument  
- Users given a pre-signed URL **inherit the permissions** of the person who generated the URL for GET / PUT  
- **Examples** :  
	- Allow only logged-in users to download a premium video on your S3 bucket  
	- Allow an ever changing list of users to download files by generating URLs dynamically  
	- Allow temporarily a user to upload a file to a precise location in our bucket
